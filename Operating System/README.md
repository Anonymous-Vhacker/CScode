# CScode
操作系统课程设计代码 实验一二三五，《计算机操作系统》 赵伟华
实验报告参考：[这里](http://lgyserver.top:3000/s/ByEnco36H)
# exp1 Linux内核编译
Linux内核编译，比较简单，照书上直接操作即可，注意编译完内核之后有一个替换内核的命令，替换完之后最好去linux的引导分区看看内核有没有被替换成自己重新编译过的内核（我记得有个文件指定启动内核的要自己改一下，里面有些路径的内容改成自己内核的路径，详情可以查阅百度）

*注意：书上实验要求另加设定nice值的系统调用，注意两个都改好了统一编译内核，不然编译两次。。编译一次起码以小时为单位，慎重慎重。*

*编译的时候 记得多核编译 make -j(你cpu的核数) 不然巨慢*

*查看内核log指令：dmesg。祝你成功*

具体代码可以查阅CSDN有学长写好的

# exp2 内核模块编程
老师要求在原来的基础上增加了进程树的打印。不带进程树的版本直接for_each_process(p) 遍历一下pcb输出就好了。带树的版本要考虑进程的父子关系。建议查一下Linux PCB构造以后读代码
代码为带进程树版本。 dmesg查看。

# exp3 Linux进程管理
### 模拟shell
额外要求在模拟shell里面增加find和grep命令。 其实理论上啥命令都可以，详见代码，代码里把不用的命令给屏蔽了，方法不止一种，可以system(),也可以exec()
### 管道通信程序
额外要求实现进程间有名管道通信
管道通信：pipe文件夹内 重点：信号量的使用
有名管道通信：fifo文件夹内 会创建一个有名文件，通过文件通信
### 消息队列机制线程通信
实验现象：在同一个shell内进行通信
重点：消息队列创建，信号量
### linux共享内存机制两个进程通信
额外要求增加进程间双向通信
思路：单向通信的基础上创建信号量用于标识哪个是发送端，总体来说都是信号量的运用，还有就是共享内存的开辟和传递函数
“乒乓memory”
# exp5 简单文件系统实现
这个是最难的了，我是在github上找了以前学长的代码魔改的。。。大家可以去给他star。。
额外要求：盘块大小可变（难!）/打印FAT数据（16进制）/实现顺序和随机读写/写入多于一个扇区的文件或目录信息
这个版本初版来源于 [lwzhuo/SimpleFileSystem](https://github.com/lwzhuo/SimpleFileSystem) 大家快去送star。。
我的改进：
- 把宏变量BLOCK_SIZE改成extern的可变变量，并存入block0引导扇区里面,以后每次初始化读block0里面的size数据作为盘块大小，但注意，小于512会出现不可预知的问题。小于256甚至文件夹都建不了
- 把输出FAT表的部分修改，原作者的意思是FAT表里的数据1 2分别代表 fat扇区和fcb扇区，但老师的意思是看出来必须是文件尾（FFFF）,所以加了个三元运算符判断了一下
- 关于随机读写，魔改了原来的write方法 具体说就是把a（追加写）魔改了一下，write 0 a的时候会输入offset，输入这个offset就可以实现随机存储。但注意，测试时好像会多读一个回车，小问题我没改，建议多写一个getchar()给读了。

## 代码读懂了最重要，希望能给有需要的人节省时间。。最好自己写，其次理解，忌直接剽代码！！
